type: trigger
name: crowdsecurity/CVE-2014-6278
description: "Detect CVE-2014-6278 Bash command substitution exploit attempt"
filter: |
  (
    evt.Parsed.http_user_agent matches ".*\\$\\(.*\\{.*\\}.*\\).*" ||
    evt.Parsed.http_path matches ".*\\$\\(.*\\{.*\\}.*\\).*" ||
    evt.Parsed.http_referer matches ".*\\$\\(.*\\{.*\\}.*\\).*" ||
    evt.Parsed.http_user_agent matches ".*\\`.*\\{.*\\}.*\\`.*" ||
    evt.Parsed.http_user_agent matches ".*\\$\\{.*\\}.*\\$\\(.*\\).*" ||
    evt.Parsed.http_user_agent matches ".*function\\s+\\w+.*\\{.*\\$\\(.*\\).*\\}.*" ||
    evt.Parsed.http_user_agent matches ".*\\(\\).*\\{.*\\$\\(.*\\{.*\\}.*\\).*\\}.*"
  ) &&
  evt.Meta.source_ip != nil
groupby: "evt.Meta.source_ip"
labels:
  type: exploit
  remediation: true
  classification:
    - attack.T1190
    - cve.CVE-2014-6278
  spoofable: 0
  confidence: 4
  behavior: "http:exploit"
  label: "Bash CVE-2014-6278 Command Substitution"
  service: web
