type: trigger
name: crowdsecurity/CVE-2014-6271
description: "Detect CVE-2014-6271 Shellshock exploit attempt"
filter: |
  (
    evt.Parsed.http_user_agent matches ".*\\(\\)\\s*\\{\\s*[:]?\\s*;\\s*\\}\\s*;.*" ||
    evt.Parsed.http_path matches ".*\\(\\)\\s*\\{\\s*[:]?\\s*;\\s*\\}\\s*;.*" ||
    evt.Parsed.http_referer matches ".*\\(\\)\\s*\\{\\s*[:]?\\s*;\\s*\\}\\s*;.*" ||
    evt.Parsed.http_user_agent matches ".*env\\s+[a-zA-Z_][a-zA-Z0-9_]*=[\"']?\\(\\).*" ||
    evt.Parsed.http_user_agent matches ".*(bash|sh)\\s*-c\\s*[\"'].*\\(\\).*" ||
    evt.Parsed.http_user_agent matches ".*echo\\s+[\"']?vulnerable[\"']?.*\\(\\).*"
  ) &&
  evt.Meta.source_ip != nil
groupby: "evt.Meta.source_ip"
labels:
  type: exploit
  remediation: true
  classification:
    - attack.T1190
    - cve.CVE-2014-6271
  spoofable: 0
  confidence: 5
  behavior: "http:exploit"
  label: "Shellshock CVE-2014-6271"
  service: web
